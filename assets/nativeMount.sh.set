#!/bin/bash
# nativemount.sh.set - Native Linux Mount Template
DISCIMAGE="$1"
if [ -z "$DISCIMAGE" ]; then exit 1; fi
if [ -f "drvltr" ]; then rm "drvltr"; fi

if command -v udisksctl &> /dev/null; then
    LOOPDEV=$(udisksctl loop-setup -f "$DISCIMAGE" | awk '{print $NF}' | sed 's/\.$//')
    if [ ! -z "$LOOPDEV" ]; then
        MOUNTPATH=$(udisksctl mount -b "$LOOPDEV" | awk '{print $NF}' | sed 's/\.$//')
        echo "$MOUNTPATH" > drvltr
        exit 0
    fi
fi
exit 1
